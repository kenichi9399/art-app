// cfg.js
// ------------------------------------------------------------
// Touching Light — Quiet Luxury (CFG v1.1)
//
// 目的：
// - 作品全体の “調律パネル”
// - 見た目と手触りの改善点（白塊縮小 / 緑紫の微量追加 / 粒子の10段階ランダム / 影 / 余白）を
//   ここだけで触れるようにする
//
// 重要：
// - 値は “上品寄り” をデフォにしています（やりすぎると白飛び・ノイズ散乱）
// - iPhone向けに PERF 系は保守的に
// ------------------------------------------------------------

window.CFG = {
  // ----------------------------------------------------------
  // Runtime / performance
  // ----------------------------------------------------------
  FPS: 60,

  // Render が内部バッファを縮小して軽くする（1.0=等倍、0.7=軽いが若干ぼやける）
  PERF_SCALE_MIN: 0.58,
  PERF_SCALE_MAX: 1.00,
  PERF_TARGET_MS: 16.6,     // 60fps基準
  PERF_CHECK_EVERY: 24,     // 何フレームごとに自動調整するか
  PERF_DOWN_TH: 1.25,
  PERF_UP_TH: 0.82,
  PERF_DOWN_RATE: 0.92,
  PERF_UP_RATE: 1.04,

  // ----------------------------------------------------------
  // Color hints (控えめ)
  // ----------------------------------------------------------
  // “白と黒以外に緑と紫を少し” → render.paperDust / bloomStamp の縁で使う
  HINT_GREEN: 0.14,   // 紙粒に混ざる確率（強すぎると安っぽくなるので控えめ）
  HINT_PURPLE: 0.11,

  // light pass 側の白飛び抑制
  LIGHT_ALPHA_CAP: 92,

  // ----------------------------------------------------------
  // Paper / texture (散らかり防止のため低め)
  // ----------------------------------------------------------
  PAPER_DOTS_STRONG: 260,
  PAPER_DOTS_SOFT: 110,
  PAPER_DOT_ALPHA_MIN: 7,
  PAPER_DOT_ALPHA_MAX: 18,

  // ----------------------------------------------------------
  // Void = 光の抜け（空の余白）
  // ----------------------------------------------------------
  // “左上の白い塊を半分” → r と light stamp を抑える設計にしている
  // ここで全体サイズを調整
  VOID_R: 135,

  // 形の歪み：円をやめる（上げすぎると生物っぽくなる）
  VOID_WARP: 0.13,

  // 余白の明るさ（黒い穴にしない）
  VOID_RAISE: 0.46,

  // 余白の呼吸感
  VOID_BREATHE: 0.16,

  // ----------------------------------------------------------
  // Long Shadow（地上の“何かわからない”影）
  // ----------------------------------------------------------
  SH_LEN: 0.92,     // 影の長さ（画面高に対する比）
  SH_ALPHA: 84,     // 影の濃さ（上げすぎ注意）
  SH_W0: 280,       // 影の上部幅
  SH_W1: 56,        // 影の下部幅

  // ----------------------------------------------------------
  // Input（触れ方）
  // ----------------------------------------------------------
  HOLD_MS: 900,     // 長押し判定
  TOUCH_POWER: 0.95,

  // ----------------------------------------------------------
  // Flow field（流れ場）
  // ----------------------------------------------------------
  // field.js 側で参照。強すぎると“ただ流れる”だけになるので抑制。
  FLOW_CELL: 44,          // 大きいほど大きな流れ（滑らか）
  FLOW_STRENGTH: 1.05,    // ベース強度
  FLOW_CURL: 0.85,        // 旋回の強さ
  FLOW_WANDER: 0.22,      // 時間変化の強さ（大きいと落ち着かない）
  FLOW_DOMAIN: 0.0046,    // ノイズ座標スケール（小さいほど大きなうねり）
  FLOW_BIAS_X: 0.10,      // わずかに横へ流す（“地上”の気配）
  FLOW_BIAS_Y: 0.04,

  // ----------------------------------------------------------
  // Particles（粒子）— 10段階ランダム & 層
  // ----------------------------------------------------------
  P_COUNT: 1500,      // iPhoneでも破綻しにくい上限寄り
  P_SPEED: 1.00,
  P_DRAG: 0.945,

  // 寿命：短いとチカチカ、長いと重い。バランス
  P_LIFE_MIN: 90,
  P_LIFE_MAX: 250,

  // “粒の大きさ/スピードにランダム性と段階を10段階”
  // particles.js/field.js がこの段階を使えるように（今後拡張用）
  P_SIZE_LEVELS: 10,
  P_SPEED_LEVELS: 10,

  // レイヤー（層）
  // density 合計は 1 目安（多少ズレてもOK）
  LAYERS: [
    // 低温：膜（太め/ゆっくり/寿命長）
    { density: 0.36, speedMul: 0.74, alpha: 0.032, width: 1.30, lifeMul: 1.28, jitter: 0.11 },
    // 中温：主層
    { density: 0.44, speedMul: 1.00, alpha: 0.022, width: 0.96, lifeMul: 1.00, jitter: 0.18 },
    // 高温：光の粒（細/速/寿命短）— 中心白飛びを避ける
    { density: 0.20, speedMul: 1.36, alpha: 0.014, width: 0.72, lifeMul: 0.82, jitter: 0.24 },
  ],

  // ----------------------------------------------------------
  // 追加の“アート性”チューニング（今後）
  // ----------------------------------------------------------
  // 例えば：夜が深いほど影が伸びる / 触れ続けると色相がずれる などの係数置き場
  ART: {
    // 余白を「抜け」として感じさせるための抑制係数（上げると白飛び抑制が強い）
    VOID_FADE: 0.75,
    // 触れたときの “抜けの発生” の強さ（sketch.js の stamp が参照しやすい）
    TOUCH_STAMP_GAIN: 1.0,
  },
};
